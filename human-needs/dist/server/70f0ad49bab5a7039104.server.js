(()=>{"use strict";const e={onAccountAuthenticate:"authentication:account-success",onPlayerConnect:"playerJoining",onPlayerDeath:"armoury:onPlayerDeath",onPlayerAuthenticate:"authentication:player-authenticated",onPlayerDisconnect:"playerDropped",onResourceStop:"onResourceStop",onContextMenuItemPressed:"armoury-overlay:context-menu-item-pressed",onPlayerEnterVehicle:"armoury:onPlayerEnterVehicle",onPlayerExitVehicle:"armoury:onPlayerExitVehicle",onPlayerClientsidedCacheLoaded:"armoury:player-resource-cache-loaded"};var t;!function(e){e[e.SERVER_TO_SERVER=0]="SERVER_TO_SERVER",e[e.SERVER_TO_CLIENT=1]="SERVER_TO_CLIENT",e[e.CLIENT_TO_SERVER=2]="CLIENT_TO_SERVER",e[e.CLIENT_TO_CLIENT=3]="CLIENT_TO_CLIENT"}(t||(t={}));const r=new Map,a=new Map,n=new Map;function s(e){return function(s){return class extends s{constructor(...i){super(...i),this.translationFile=null==e?void 0:e.translationFile,r.has(s)&&r.get(s).forEach((([e,r,a])=>{a===t.CLIENT_TO_CLIENT?on(r,super[e].bind(this)):onNet(r,super[e].bind(this))})),a.has(s)&&a.get(s).forEach((e=>{exports(e,super[e].bind(this))})),n.has(s)&&n.get(s).forEach((([e,t])=>{IsDuplicityVersion()?RegisterCommand(e.toLowerCase(),((r,a,n)=>{Number(global.exports.authentication.getPlayerInfo(r,"adminLevel"))<t||super[e].call(this,r,a,n)}),!1):RegisterCommand(e.toLowerCase(),((t,r,a)=>{super[e].call(this,r,a)}),!1)}))}}}}function i(a){return function(n,s,i){const o=e[s]||(null==a?void 0:a.eventName),l=(null==a?void 0:a.direction)||t.CLIENT_TO_SERVER;(null==o?void 0:o.length)?(r.has(n.constructor)||r.set(n.constructor,[]),r.get(n.constructor).some((([e,t,r])=>e===s))||r.get(n.constructor).push([s,o,l])):console.error(`${s} is not recognized as a default event, thus this listener won't work. Please use the eventName property inside the data parameter.`)}}function o(){return function(e,t,r){a.has(e.constructor)||a.set(e.constructor,[]),a.get(e.constructor).some((e=>e===t))||a.get(e.constructor).push(t)}}var l=function(e,t,r,a){var n,s=arguments.length,i=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(s<3?n(i):s>3?n(t,r,i):n(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i};let u=class extends class{constructor(){this.routingBucketCondition=(e,t)=>!0,this.assignServerBaseListeners()}RegisterAdminCommand(e,t,r,a){RegisterCommand(e,((e,a,n)=>{Number(global.exports.authentication.getPlayerInfo(e,"adminLevel"))<t||r(e,a,n)}),a)}assignServerBaseListeners(){onNet(`${GetCurrentResourceName()}:set-client-routing-bucket`,((e,t)=>{this.routingBucketCondition(e,t)&&SetEntityRoutingBucket(e,t)}))}}{constructor(){super(...arguments),this._virtualWorldsWithPlayers=new Map}get virtualWorldsWithPlayers(){return this._virtualWorldsWithPlayers}onPlayerEnteredScope(e){TriggerClientEvent(`${GetCurrentResourceName()}:refresh-virtual-world`,e.for)}setPlayerVirtualWorld(e,t){const r=this.getPlayerVirtualWorld(e);isNaN(r)||this._virtualWorldsWithPlayers.set(r,(this._virtualWorldsWithPlayers.has(r)?this._virtualWorldsWithPlayers.get(r):[]).filter((t=>t!==e)));const a=[...this._virtualWorldsWithPlayers.has(t)?this._virtualWorldsWithPlayers.get(t):[],e];this._virtualWorldsWithPlayers.set(t,a),global.exports.authentication.setPlayerInfo(e,"virtualWorld",t)}getPlayerVirtualWorld(e){return Math.max(0,Number(global.exports.authentication.getPlayerInfo(e,"virtualWorld")))}removeClientsideVehicles(){TriggerClientEvent(`${GetCurrentResourceName()}:ARM_remove-vehicles`,-1)}};l([i({eventName:"playerEnteredScope"})],u.prototype,"onPlayerEnteredScope",null),u=l([s()],u);var h=function(e,t,r,a){var n,s=arguments.length,i=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(s<3?n(i):s>3?n(t,r,i):n(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i};let c=class extends u{constructor(){super(...arguments),this._translationLanguage="ro",this._clientsidedResourceMap=new Map}get translationLanguage(){return this._translationLanguage}get clientsidedResourceMap(){return this._clientsidedResourceMap}getPlayerClientsidedCacheKey(e,t){if(this._clientsidedResourceMap.has(e)){const r=this._clientsidedResourceMap.get(e);if(r[t])return r[t]}return null}updatePlayerClientsidedCacheKey(e,t,r){const a=this._clientsidedResourceMap.has(e)&&this._clientsidedResourceMap.get(e)||{};a[t]=r,this._clientsidedResourceMap.set(e,a),TriggerClientEvent("armoury-overlay:update-resource-metadata",e,GetCurrentResourceName(),t,r)}onPlayerClientsidedCacheLoaded(e){e[GetCurrentResourceName()]&&this._clientsidedResourceMap.set(source,e[GetCurrentResourceName()])}onPlayerDisconnect(){this._clientsidedResourceMap.has(source)&&this._clientsidedResourceMap.delete(source)}translate(e,t){let r=this.translationFile[this._translationLanguage][e];return t&&Object.keys(t).forEach((e=>{r=r.replace(`{${e}}`,t[e])})),r}setTranslationLanguage(e){this._translationLanguage=e}};h([i()],c.prototype,"onPlayerClientsidedCacheLoaded",null),h([i()],c.prototype,"onPlayerDisconnect",null),c=h([s()],c);const g={apple:{hungerGain:10},chocolate:{hungerGain:15},donut:{hungerGain:20},sandwich:{hungerGain:30},water:{thirstGain:50},coke:{thirstGain:30},red_bull:{thirstGain:30},cold_coffee:{thirstGain:30,hungerGain:5},beer_can:{thirstGain:20,drunknessGain:25},rum:{thirstGain:5,drunknessGain:50},whiskey:{thirstGain:5,drunknessGain:50},champagne:{thirstGain:10,drunknessGain:20}};var p=function(e,t,r,a){var n,s=arguments.length,i=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(s<3?n(i):s>3?n(t,r,i):n(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i};let y=class extends c{constructor(){super(),this.hungerMap=new Map,this.thirstMap=new Map,this.intervals=[],setTimeout((()=>this.loadNeedsMaps()),1e3),this.assignIntervals()}getPlayerHungerLevel(e){return this.hungerMap.has(e)?this.hungerMap.get(e):100}getPlayerThirstLevel(e){return this.thirstMap.has(e)?this.thirstMap.get(e):100}setPlayerHungerLevel(e,t){this.hungerMap.has(e)&&(this.hungerMap.set(e,Math.min(t,100)),global.exports["armoury-overlay"].updateItem(e,{id:"hunger",icon:"lunch_dining",value:`${Math.min(t,100)}%`}))}setPlayerThirstLevel(e,t){this.thirstMap.has(e)&&(this.thirstMap.set(e,Math.min(t,100)),global.exports["armoury-overlay"].updateItem(e,{id:"thirst",icon:"water_drop",value:`${Math.min(t,100)}%`}))}onPlayerAuthenticate(e,t){this.loadPlayerIntoNeedsMaps(e,t.hunger,t.thirst)}onPlayerInventoryItemClicked(e){g[e.item.image]&&(g[e.item.image].hungerGain&&(this.setPlayerHungerLevel(source,this.getPlayerHungerLevel(source)+Number(g[e.item.image].hungerGain)),this.updateHungerThirstMessage(source)),g[e.item.image].healthGain,g[e.item.image].thirstGain&&(this.setPlayerThirstLevel(source,this.getPlayerThirstLevel(source)+Number(g[e.item.image].thirstGain)),this.updateHungerThirstMessage(source)),global.exports.inventory.consumePlayerItem(source,e.item,1))}onPlayerDisconnect(){super.onPlayerDisconnect(),this.hungerMap.has(source)&&this.hungerMap.delete(source),this.thirstMap.has(source)&&this.thirstMap.delete(source)}onResourceStop(e){e===GetCurrentResourceName()&&(this.clearIntervals(),Array.from(this.hungerMap.keys()).forEach((e=>{global.exports.authentication.setPlayerInfo(e,"hunger",global.exports.authentication.getPlayerInfo(e,"hunger"))})),Array.from(this.thirstMap.keys()).forEach((e=>{global.exports.authentication.setPlayerInfo(e,"thirst",global.exports.authentication.getPlayerInfo(e,"thirst"))})))}assignIntervals(){this.intervals.push(setInterval(this.onHungerDecrement.bind(this),Math.floor(3e4)),setInterval(this.onThirstDecrement.bind(this),Math.floor(24e3)))}clearIntervals(){this.intervals.forEach((e=>{clearInterval(e)}))}onHungerDecrement(){Array.from(this.hungerMap.keys()).forEach((e=>{this.decrementHungerForPlayer(e)}))}onThirstDecrement(){Array.from(this.thirstMap.keys()).forEach((e=>{this.decrementThirstForPlayer(e)}))}decrementHungerForPlayer(e){const t=this.hungerMap.get(e);this.hungerMap.set(e,Math.max(t-1,0)),this.updateHungerThirstMessage(e),0===t&&TriggerClientEvent(`${GetCurrentResourceName()}:apply-player-damage`,e,5),global.exports["armoury-overlay"].updateItem(e,{id:"hunger",icon:"lunch_dining",value:`${Math.floor(t)}%`})}decrementThirstForPlayer(e){const t=this.thirstMap.get(e);this.thirstMap.set(e,Math.max(t-1,0)),this.updateHungerThirstMessage(e),0===t&&TriggerClientEvent(`${GetCurrentResourceName()}:apply-player-damage`,e,2.5),global.exports["armoury-overlay"].updateItem(e,{id:"thirst",icon:"water_drop",value:`${Math.floor(t)}%`})}loadNeedsMaps(){global.exports.authentication.getAuthenticatedPlayers().forEach((e=>{this.loadPlayerIntoNeedsMaps(e,global.exports.authentication.getPlayerInfo(e,"hunger"),global.exports.authentication.getPlayerInfo(e,"thirst"))}))}loadPlayerIntoNeedsMaps(e,t,r){this.hungerMap.set(e,null==t?100:t),this.thirstMap.set(e,null==r?100:r),this.decrementThirstForPlayer(e),this.decrementHungerForPlayer(e)}updateHungerThirstMessage(e){this.getPlayerHungerLevel(e)<20||this.getPlayerThirstLevel(e)<20?global.exports["armoury-overlay"].setMessage(e,{id:"needs-message",content:this.getPlayerHungerLevel(e)<20&&this.getPlayerThirstLevel(e)<20?this.translate("tooltip_hungry_and_thirsty"):this.getPlayerHungerLevel(e)<2?this.translate("tooltip_hungry"):this.translate("tooltip_thirsty")}):global.exports["armoury-overlay"].deleteMessage(e,{id:"needs-message"})}};p([o()],y.prototype,"getPlayerHungerLevel",null),p([o()],y.prototype,"getPlayerThirstLevel",null),p([o()],y.prototype,"setPlayerHungerLevel",null),p([o()],y.prototype,"setPlayerThirstLevel",null),p([i()],y.prototype,"onPlayerAuthenticate",null),p([i({eventName:"inventory:inventory-item-clicked"})],y.prototype,"onPlayerInventoryItemClicked",null),p([i()],y.prototype,"onPlayerDisconnect",null),p([i()],y.prototype,"onResourceStop",null),y=p([s({translationFile:{en:{tooltip_hungry_and_thirsty:"You are hungry and thirsty. Buy food/drinks at any 24/7 shop.",tooltip_hungry:"You are hungry. Buy food at any 24/7 shop.",tooltip_thirsty:"You are thirsty. Buy drinks at any 24/7 shop."},ro:{tooltip_hungry_and_thirsty:"Iti este foame si sete. Cumpara mancare/bauturi la orice magazin 24/7.",tooltip_hungry:"Iti este foame. Cumpara mancare la orice magazin 24/7.",tooltip_thirsty:"Iti este sete. Cumpara bauturi la orice magazin 24/7."}}})],y),new y})();