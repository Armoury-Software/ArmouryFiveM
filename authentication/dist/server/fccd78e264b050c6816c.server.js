/*! For license information please see fccd78e264b050c6816c.server.js.LICENSE.txt */
(()=>{"use strict";const e=["k","M","G","T","P","E"],t=(t,r)=>{let A=t<0;if(t=Math.abs(t),Number.isNaN(t))return null;if(t<1e3)return t;const n=Math.floor(Math.log(t)/Math.log(1e3));return(A?"-":"")+(t/Math.pow(1e3,n)).toFixed(r)+e[n-1]},r={onAccountAuthenticate:"authentication:account-success",onPlayerConnect:"playerJoining",onPlayerDeath:"armoury:onPlayerDeath",onPlayerAuthenticate:"authentication:player-authenticated",onPlayerDisconnect:"playerDropped",onResourceStop:"onResourceStop",onContextMenuItemPressed:"armoury-overlay:context-menu-item-pressed",onPlayerEnterVehicle:"armoury:onPlayerEnterVehicle",onPlayerExitVehicle:"armoury:onPlayerExitVehicle",onPlayerClientsidedCacheLoaded:"armoury:player-resource-cache-loaded"};var A;!function(e){e[e.SERVER_TO_SERVER=0]="SERVER_TO_SERVER",e[e.SERVER_TO_CLIENT=1]="SERVER_TO_CLIENT",e[e.CLIENT_TO_SERVER=2]="CLIENT_TO_SERVER",e[e.CLIENT_TO_CLIENT=3]="CLIENT_TO_CLIENT"}(A||(A={}));const n=new Map,a=new Map,o=new Map;function i(e){return function(t){return class extends t{constructor(...r){super(...r),this.translationFile=null==e?void 0:e.translationFile,n.has(t)&&n.get(t).forEach((([e,t,r])=>{r===A.CLIENT_TO_CLIENT?on(t,super[e].bind(this)):onNet(t,super[e].bind(this))})),a.has(t)&&a.get(t).forEach((e=>{exports(e,super[e].bind(this))})),o.has(t)&&o.get(t).forEach((([e,t])=>{IsDuplicityVersion()?RegisterCommand(e.toLowerCase(),((r,A,n)=>{Number(global.exports.authentication.getPlayerInfo(r,"adminLevel"))<t||super[e].call(this,r,A,n)}),!1):RegisterCommand(e.toLowerCase(),((t,r,A)=>{super[e].call(this,r,A)}),!1)}))}}}}function s(e){return function(t,a,o){const i=r[a]||(null==e?void 0:e.eventName),s=(null==e?void 0:e.direction)||A.CLIENT_TO_SERVER;(null==i?void 0:i.length)?(n.has(t.constructor)||n.set(t.constructor,[]),n.get(t.constructor).some((([e,t,r])=>e===a))||n.get(t.constructor).push([a,i,s])):console.error(`${a} is not recognized as a default event, thus this listener won't work. Please use the eventName property inside the data parameter.`)}}function l(){return function(e,t,r){a.has(e.constructor)||a.set(e.constructor,[]),a.get(e.constructor).some((e=>e===t))||a.get(e.constructor).push(t)}}var c=function(e,t,r,A){var n,a=arguments.length,o=a<3?t:null===A?A=Object.getOwnPropertyDescriptor(t,r):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,A);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(o=(a<3?n(o):a>3?n(t,r,o):n(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o};let u=class extends class{constructor(){this.routingBucketCondition=(e,t)=>!0,this.assignServerBaseListeners()}RegisterAdminCommand(e,t,r,A){RegisterCommand(e,((e,A,n)=>{Number(global.exports.authentication.getPlayerInfo(e,"adminLevel"))<t||r(e,A,n)}),A)}assignServerBaseListeners(){onNet(`${GetCurrentResourceName()}:set-client-routing-bucket`,((e,t)=>{this.routingBucketCondition(e,t)&&SetEntityRoutingBucket(e,t)}))}setRoutingBucket(e,t){SetEntityRoutingBucket(GetPlayerPed(e),t),TriggerClientEvent(`${GetCurrentResourceName()}:set-routing-bucket`,e,t)}}{constructor(){super(...arguments),this._virtualWorldsWithPlayers=new Map}get virtualWorldsWithPlayers(){return this._virtualWorldsWithPlayers}onPlayerEnteredScope(e){TriggerClientEvent(`${GetCurrentResourceName()}:refresh-virtual-world`,e.for)}setPlayerVirtualWorld(e,t){const r=this.getPlayerVirtualWorld(e);isNaN(r)||this._virtualWorldsWithPlayers.set(r,(this._virtualWorldsWithPlayers.has(r)?this._virtualWorldsWithPlayers.get(r):[]).filter((t=>t!==e)));const A=[...this._virtualWorldsWithPlayers.has(t)?this._virtualWorldsWithPlayers.get(t):[],e];this._virtualWorldsWithPlayers.set(t,A),global.exports.authentication.setPlayerInfo(e,"virtualWorld",t)}getPlayerVirtualWorld(e){return Math.max(0,Number(global.exports.authentication.getPlayerInfo(e,"virtualWorld")))}removeClientsideVehicles(){TriggerClientEvent(`${GetCurrentResourceName()}:ARM_remove-vehicles`,-1)}};c([s({eventName:"playerEnteredScope"})],u.prototype,"onPlayerEnteredScope",null),u=c([i()],u);var h=function(e,t,r,A){var n,a=arguments.length,o=a<3?t:null===A?A=Object.getOwnPropertyDescriptor(t,r):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,A);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(o=(a<3?n(o):a>3?n(t,r,o):n(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o};let g=class extends u{constructor(){super(...arguments),this._translationLanguage="ro",this._clientsidedResourceMap=new Map}get translationLanguage(){return this._translationLanguage}get clientsidedResourceMap(){return this._clientsidedResourceMap}getPlayerClientsidedCacheKey(e,t){if(this._clientsidedResourceMap.has(e)){const r=this._clientsidedResourceMap.get(e);if(r[t])return r[t]}return null}updatePlayerClientsidedCacheKey(e,t,r){const A=this._clientsidedResourceMap.has(e)&&this._clientsidedResourceMap.get(e)||{};A[t]=r,this._clientsidedResourceMap.set(e,A),TriggerClientEvent("armoury-overlay:update-resource-metadata",e,GetCurrentResourceName(),t,r)}onPlayerClientsidedCacheLoaded(e){e[GetCurrentResourceName()]&&this._clientsidedResourceMap.set(source,e[GetCurrentResourceName()])}onPlayerDisconnect(){this._clientsidedResourceMap.has(source)&&this._clientsidedResourceMap.delete(source)}translate(e,t){let r=this.translationFile[this._translationLanguage][e];return t&&Object.keys(t).forEach((e=>{r=r.replace(`{${e}}`,t[e])})),r}setTranslationLanguage(e){this._translationLanguage=e}};function d(e,t,r,A){return new(r||(r=Promise))((function(n,a){function o(e){try{s(A.next(e))}catch(e){a(e)}}function i(e){try{s(A.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,i)}s((A=A.apply(e,t||[])).next())}))}h([s()],g.prototype,"onPlayerClientsidedCacheLoaded",null),h([s()],g.prototype,"onPlayerDisconnect",null),g=h([i()],g);class Q{constructor(){this.mutex=Promise.resolve()}lock(){let e=()=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}dispatch(e){return d(this,void 0,void 0,(function*(){const t=yield this.lock();try{return yield Promise.resolve(e())}finally{t()}}))}}var I;const C="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,y=null!==(I=C.Buffer)&&void 0!==I?I:null,E=C.TextEncoder?new C.TextEncoder:null;function p(e,t){return(15&e)+(e>>6|e>>3&8)<<4|(15&t)+(t>>6|t>>3&8)}const B="a".charCodeAt(0)-10,f="0".charCodeAt(0);function w(e,t,r){let A=0;for(let n=0;n<r;n++){let r=t[n]>>>4;e[A++]=r>9?r+B:r+f,r=15&t[n],e[A++]=r>9?r+B:r+f}return String.fromCharCode.apply(null,e)}const m=null!==y?e=>{if("string"==typeof e){const t=y.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(y.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:e=>{if("string"==typeof e)return E.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=new Uint8Array(256);for(let e=0;e<b.length;e++)P[b.charCodeAt(e)]=e;function k(e){const t=function(e){let t=Math.floor(.75*e.length);const r=e.length;return"="===e[r-1]&&(t-=1,"="===e[r-2]&&(t-=1)),t}(e),r=e.length,A=new Uint8Array(t);let n=0;for(let t=0;t<r;t+=4){const r=P[e.charCodeAt(t)],a=P[e.charCodeAt(t+1)],o=P[e.charCodeAt(t+2)],i=P[e.charCodeAt(t+3)];A[n]=r<<2|a>>4,n+=1,A[n]=(15&a)<<4|o>>2,n+=1,A[n]=(3&o)<<6|63&i,n+=1}return A}const v=16384,D=new Q,F=new Map;function S(e,t){return d(this,void 0,void 0,(function*(){let r=null,A=null,n=!1;if("undefined"==typeof WebAssembly)throw new Error("WebAssembly is not supported in this environment!");const a=()=>new DataView(r.exports.memory.buffer).getUint32(r.exports.STATE_SIZE,!0),o=D.dispatch((()=>d(this,void 0,void 0,(function*(){if(!F.has(e.name)){const t=k(e.data),r=WebAssembly.compile(t);F.set(e.name,r)}const t=yield F.get(e.name);r=yield WebAssembly.instantiate(t,{})})))),i=(e=null)=>{n=!0,r.exports.Hash_Init(e)},s=e=>{if(!n)throw new Error("update() called before init()");(e=>{let t=0;for(;t<e.length;){const n=e.subarray(t,t+v);t+=n.length,A.set(n),r.exports.Hash_Update(n.length)}})(m(e))},l=new Uint8Array(2*t),c=(e,a=null)=>{if(!n)throw new Error("digest() called before init()");return n=!1,r.exports.Hash_Final(a),"binary"===e?A.slice(0,t):w(l,A,t)},u=e=>"string"==typeof e?e.length<4096:e.byteLength<v;let h=u;switch(e.name){case"argon2":case"scrypt":h=()=>!0;break;case"blake2b":case"blake2s":h=(e,t)=>t<=512&&u(e);break;case"blake3":h=(e,t)=>0===t&&u(e);break;case"xxhash64":case"xxhash3":case"xxhash128":h=()=>!1}return yield(()=>d(this,void 0,void 0,(function*(){r||(yield o);const e=r.exports.Hash_GetBuffer(),t=r.exports.memory.buffer;A=new Uint8Array(t,e,v)})))(),{getMemory:()=>A,writeMemory:(e,t=0)=>{A.set(e,t)},getExports:()=>r.exports,setMemorySize:e=>{r.exports.Hash_SetMemorySize(e);const t=r.exports.Hash_GetBuffer(),n=r.exports.memory.buffer;A=new Uint8Array(n,t,e)},init:i,update:s,digest:c,save:()=>{if(!n)throw new Error("save() can only be called after init() and before digest()");const t=r.exports.Hash_GetState(),A=a(),o=r.exports.memory.buffer,i=new Uint8Array(o,t,A),s=new Uint8Array(4+A);return function(e,t){const r=t.length>>1;for(let A=0;A<r;A++){const r=A<<1;e[A]=p(t.charCodeAt(r),t.charCodeAt(r+1))}}(s,e.hash),s.set(i,4),s},load:t=>{if(!(t instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");const A=r.exports.Hash_GetState(),o=a(),i=4+o,s=r.exports.memory.buffer;if(t.length!==i)throw new Error(`Bad state length (expected ${i} bytes, got ${t.length})`);if(!function(e,t){if(e.length!==2*t.length)return!1;for(let r=0;r<t.length;r++){const A=r<<1;if(t[r]!==p(e.charCodeAt(A),e.charCodeAt(A+1)))return!1}return!0}(e.hash,t.subarray(0,4)))throw new Error("This state was written by an incompatible hash implementation");const l=t.subarray(4);new Uint8Array(s,A,o).set(l),n=!0},calculate:(e,n=null,a=null)=>{if(!h(e,n))return i(n),s(e),c("hex",a);const o=m(e);return A.set(o),r.exports.Hash_Calculate(o.length,n,a),w(l,A,t)},hashLength:t}}))}new Q,new Q,new DataView(new ArrayBuffer(4)),new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q,new ArrayBuffer(8),new Q,new ArrayBuffer(8),new Q,new ArrayBuffer(8),new Q;var N={name:"whirlpool",data:"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",hash:"358808f8"};const x=new Q;let U=null;new Q;var R=function(e,t,r,A){var n,a=arguments.length,o=a<3?t:null===A?A=Object.getOwnPropertyDescriptor(t,r):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,A);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(o=(a<3?n(o):a>3?n(t,r,o):n(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o},O=function(e,t,r,A){return new(r||(r=Promise))((function(n,a){function o(e){try{s(A.next(e))}catch(e){a(e)}}function i(e){try{s(A.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,i)}s((A=A.apply(e,t||[])).next())}))};let G=class extends g{constructor(){super(...arguments),this.cachedPlayerProperties=[],this.authenticatedPlayers=new Map,this.playersAuthenticatedWithAccountIds=new Map,this.maxIdOnServer=0}onAuthenticateBegin(e,t){return O(this,void 0,void 0,(function*(){const r=null!=t?t:source,A=yield function(e){if(null===U)return function(e,t,r){return d(this,void 0,void 0,(function*(){const A=yield e.lock(),n=yield S(t,r);return A(),n}))}(x,N,64).then((t=>(U=t,U.calculate(e))));try{const t=U.calculate(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(this.getHashPasswordWithSalt(e.password,e.email));if(e.isAuthenticating){const t=yield global.exports.oxmysql.single_async("SELECT * FROM `accounts` WHERE email=? AND password=?",[e.email,A]);t?this.authenticatePlayer(r,t):TriggerClientEvent("authentication:login-error",r,"Authentication failed - incorrect email and password combination.")}else try{if(!(yield global.exports.oxmysql.insert_async("INSERT INTO `accounts`(`name`, `password`, `email`) VALUES (?, ?, ?)",[GetPlayerName(r),A,e.email])))throw new Error;this.onAuthenticateBegin({email:e.email,password:e.password,isAuthenticating:!0},r)}catch(e){TriggerClientEvent(`${GetCurrentResourceName()}:register-error`,r,"Registration failed - that email already exists.")}}))}setPlayerInfo(e,r,A,n=!0,...a){let o=A;if((Array.isArray(A)||"object"==typeof A)&&(o=JSON.stringify(A)),"cash"===r){global.exports["armoury-overlay"].updateItem(e,{id:r,icon:"attach_money",value:"$"+(Math.abs(o)<999999?(i=o,i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")):t(o,2))});const A=this.getPlayerInfo(e,"cash"),n=Number(o)-Number(A||0);0!==n&&0!==A&&global.exports["armoury-overlay"].showMoneyGainOverlay(e,n)}var i;if("id"===r&&(o>this.maxIdOnServer&&(this.maxIdOnServer=o),global.exports["armoury-overlay"].updateItem(e,{id:r,icon:"person",value:o.toString().padStart(Math.max(6,this.maxIdOnServer.toString().length),"0")})),SetConvarReplicated(`${e}_PI_${r}`,o.toString()),!n&&this.cachedPlayerProperties.includes(r)){let t=`${r} = ?`;a.forEach((e=>{t+=`, ${e.stat} = ?`})),global.exports.oxmysql.update_async(`UPDATE \`players\` SET ${t} WHERE id = ?`,[o,...a.map((e=>Array.isArray(e._value)||"object"==typeof e._value?JSON.stringify(e._value):e._value)),this.getPlayerInfo(e,"id")])}}getOfflinePlayerInfo(e,...t){return O(this,void 0,void 0,(function*(){let r=yield global.exports.oxmysql.query_async(`SELECT ${t.join(",")} FROM players WHERE id = ?`,[e]);return(null==r?void 0:r[0])||null}))}getPlayerInfo(e,t){let r=GetConvar(`${e}_PI_${t}`,"-1");var A;if(A=r.toString(),!/^\s*$/.test(A)&&(A=(A=(A=A.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@")).replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]")).replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(A))&&(r=JSON.parse(r,(function(e,t){return"object"==typeof t||isNaN(t)?t:Number(t)}))),"hoursPlayed"===t){const A=Number(r)+this.computeHoursPlayed(e);return this.setPlayerInfo(e,t,A),A}return r}getAuthenticatedPlayers(e){return e?Array.from(this.authenticatedPlayers.keys()).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.authenticatedPlayers.get(t)})),{}):Array.from(this.authenticatedPlayers.keys())}computeHoursPlayed(e){let t=0;return this.authenticatedPlayers.has(e)&&(t=.017*Math.floor(Math.abs(this.authenticatedPlayers.get(e).lastHoursPlayedCheck.getTime()-(new Date).getTime())/6e4%60),this.authenticatedPlayers.set(e,Object.assign(Object.assign({},this.authenticatedPlayers.get(e)),{lastHoursPlayedCheck:new Date}))),t}authenticatePlayer(e,t){return O(this,void 0,void 0,(function*(){const r=yield global.exports.oxmysql.query_async("SELECT * FROM players WHERE accountId = ?",[t.id]);r?(this.playersAuthenticatedWithAccountIds.set(e,t.id),TriggerClientEvent(`${GetCurrentResourceName()}:account-success-client`,e),emit(`${GetCurrentResourceName()}:account-success`,e,r)):TriggerClientEvent(`${GetCurrentResourceName()}:account-login-error`,e,"Authentication failed - unknown error occured.")}))}loadPlayerCharacter(e,t){var r;for(var A in this.setBasicOverlaysFor(e),global.exports.armoury.unblockPlayerTime(e),t)t.hasOwnProperty(A)&&(this.setPlayerInfo(e,A,t[A]),-1===this.cachedPlayerProperties.indexOf(A)&&this.cachedPlayerProperties.push(A));this.authenticatedPlayers.set(e,Object.assign(Object.assign({},t),{lastHoursPlayedCheck:new Date})),this.spawnPlayer(e,!(null===(r=this.getPlayerInfo(e,"lastLocation"))||void 0===r?void 0:r.length)),TriggerClientEvent("authentication:success",e),emit("authentication:player-authenticated",e,t),this.playersAuthenticatedWithAccountIds.delete(e)}onCharacterSelected(e,t){return O(this,void 0,void 0,(function*(){const r=null!=t?t:source;if(Number(e.age)>0){const t=yield global.exports.oxmysql.single_async("SELECT * FROM `players` WHERE id=? AND accountId=?",[e.id,this.playersAuthenticatedWithAccountIds.get(r)]);t?this.loadPlayerCharacter(r,t):TriggerClientEvent(`${GetCurrentResourceName()}:login-error`,r,"Authentication failed - unknown error.")}}))}onCharacterCreated(e,t){return O(this,void 0,void 0,(function*(){const r=null!=t?t:source;try{const t=yield global.exports.oxmysql.insert_async("INSERT INTO `players`(`accountId`, `name`, `cash`, `bank`, `outfit`) VALUES (?, ?, ?, ?, ?)",[this.playersAuthenticatedWithAccountIds.get(r),e.name,M.defaultCash,M.defaultBank,JSON.stringify(e.componentVariations.reduce(((e,t,r)=>Object.assign(Object.assign({},e),{components:Object.assign(Object.assign({},e.components),{[r]:{drawableId:t[0],textureId:t[1],paletteId:t[2]}})})),{components:{clothingId:["clothing",r,Date.now().toString().substring(-8)].join("_")},title:["clothing",r,Date.now().toString().substring(-8)].join("_")}))]);if(!t)throw new Error;this.onCharacterSelected(Object.assign(Object.assign({},e),{id:t}),r)}catch(t){console.log(`An error has occured when creating the character for ${e.name} ([${r}] ${GetPlayerName(r)})`)}}))}onPlayerConnect(){global.exports.armoury.blockPlayerTime(source,0,0,0)}spawnPlayer(e,t){const r=this.getPlayerInfo(e,"lastLocation"),A=t?[248.3087615966797,-342.34698486328125,44.46502304077148]:r.slice(0,4);r&&r[4]&&SetEntityRoutingBucket(GetPlayerPed(e),r[4]),TriggerClientEvent("authentication:spawn-player",e,A)}onResourceStop(e){e===GetCurrentResourceName()&&(Array.from(this.authenticatedPlayers.keys()).forEach((e=>{this.savePlayerCriticalStats(e)})),this.authenticatedPlayers.clear())}onPlayerDisconnect(){super.onPlayerDisconnect(),this.savePlayerCriticalStats(source),emit(`${GetCurrentResourceName()}:player-logout`,source),this.clearPlayerInfo(source)}savePlayerCriticalStats(e){if(this.authenticatedPlayers.has(e)){const t=GetPlayerPed(e);this.setPlayerInfo(e,"hoursPlayed",Number(this.getPlayerInfo(e,"hoursPlayed")),!1,{stat:"cash",_value:Number(this.getPlayerInfo(e,"cash"))},{stat:"bank",_value:Number(this.getPlayerInfo(e,"bank"))},{stat:"weapons",_value:this.getPlayerInfo(e,"weapons")},{stat:"drugs",_value:this.getPlayerInfo(e,"drugs")},{stat:"xp",_value:this.getPlayerInfo(e,"xp")},{stat:"hunger",_value:global.exports["human-needs"].getPlayerHungerLevel(e)},{stat:"thirst",_value:global.exports["human-needs"].getPlayerThirstLevel(e)},{stat:"lastLocation",_value:[GetEntityCoords(t)[0],GetEntityCoords(t)[1],GetEntityCoords(t)[2],GetEntityHeading(t),GetEntityRoutingBucket(t)]}),this.authenticatedPlayers.delete(e)}}getHashPasswordWithSalt(e,t){return t.slice(0,3)+e+t.slice(3,6)}clearPlayerInfo(e){this.cachedPlayerProperties.forEach((t=>{SetConvarReplicated(`${e}_PI_${t}`,"-1")}))}setBasicOverlaysFor(e){global.exports["armoury-overlay"].updateItem(e,{id:"cash",icon:"attach_money",value:"$0"}),global.exports["armoury-overlay"].updateItem(e,{id:"id",icon:"person",value:"ID 0"}),global.exports["armoury-overlay"].updateItem(e,{id:"level",icon:"hourglass_bottom",value:"Level 1"}),global.exports["armoury-overlay"].updateItem(e,{id:"hunger",icon:"lunch_dining",value:"100%"}),global.exports["armoury-overlay"].updateItem(e,{id:"thirst",icon:"water_drop",value:"100%"}),global.exports["armoury-overlay"].updateItem(e,{id:"mic",icon:"volume_down",value:"0%",redIgnored:!0})}};R([s({eventName:`${GetCurrentResourceName()}:authenticate`})],G.prototype,"onAuthenticateBegin",null),R([l()],G.prototype,"setPlayerInfo",null),R([l()],G.prototype,"getOfflinePlayerInfo",null),R([l()],G.prototype,"getPlayerInfo",null),R([l()],G.prototype,"getAuthenticatedPlayers",null),R([s({eventName:"character-creation:character-selected"})],G.prototype,"onCharacterSelected",null),R([s({eventName:"character-creation:character-created"})],G.prototype,"onCharacterCreated",null),R([s()],G.prototype,"onPlayerConnect",null),R([s()],G.prototype,"onResourceStop",null),R([s()],G.prototype,"onPlayerDisconnect",null),G=R([i({translationFile:{en:{id:"ID"},ro:{id:"CNP"}}})],G);const M={defaultCash:500,defaultBank:1e3};new G})();