(()=>{"use strict";const e={onPlayerDeath:"armoury:onPlayerDeath",onPlayerAuthenticate:"authentication:player-authenticated",onPlayerDisconnect:"playerDropped",onResourceStop:"onResourceStop",onContextMenuItemPressed:"armoury-overlay:context-menu-item-pressed",onPlayerEnterVehicle:"armoury:onPlayerEnterVehicle",onPlayerExitVehicle:"armoury:onPlayerExitVehicle",onPlayerClientsidedCacheLoaded:"armoury:player-resource-cache-loaded"};var t;!function(e){e[e.SERVER_TO_SERVER=0]="SERVER_TO_SERVER",e[e.SERVER_TO_CLIENT=1]="SERVER_TO_CLIENT",e[e.CLIENT_TO_SERVER=2]="CLIENT_TO_SERVER",e[e.CLIENT_TO_CLIENT=3]="CLIENT_TO_CLIENT"}(t||(t={}));const r=new Map,o=new Map,n=new Map;function s(){return function(e){return class extends e{constructor(...s){super(...s),r.has(e)&&r.get(e).forEach((([e,r,o])=>{o===t.CLIENT_TO_CLIENT?on(r,super[e].bind(this)):onNet(r,super[e].bind(this))})),o.has(e)&&o.get(e).forEach((e=>{exports(e,super[e].bind(this))})),n.has(e)&&n.get(e).forEach((([e,t])=>{RegisterCommand(e.toLowerCase(),((r,o,n)=>{Number(global.exports.authentication.getPlayerInfo(r,"adminLevel"))<t||super[e].call(this,r,o,n)}),!1)}))}}}}function l(o){return function(n,s,l){const a=e[s]||(null==o?void 0:o.eventName),i=(null==o?void 0:o.direction)||t.CLIENT_TO_SERVER;(null==a?void 0:a.length)?(r.has(n.constructor)||r.set(n.constructor,[]),r.get(n.constructor).some((([e,t,r])=>e===s))||r.get(n.constructor).push([s,a,i])):console.error(`${s} is not recognized as a default event, thus this listener won't work. Please use the eventName property inside the data parameter.`)}}function a(){return function(e,t,r){o.has(e.constructor)||o.set(e.constructor,[]),o.get(e.constructor).some((e=>e===t))||o.get(e.constructor).push(t)}}var i=function(e,t,r,o){var n,s=arguments.length,l=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(l=(s<3?n(l):s>3?n(t,r,l):n(t,r))||l);return s>3&&l&&Object.defineProperty(t,r,l),l};let c=class extends class{constructor(){this.routingBucketCondition=(e,t)=>!0,this.assignServerBaseListeners()}RegisterAdminCommand(e,t,r,o){RegisterCommand(e,((e,o,n)=>{Number(global.exports.authentication.getPlayerInfo(e,"adminLevel"))<t||r(e,o,n)}),o)}assignServerBaseListeners(){onNet(`${GetCurrentResourceName()}:set-client-routing-bucket`,((e,t)=>{this.routingBucketCondition(e,t)&&SetEntityRoutingBucket(e,t)}))}}{constructor(){super(...arguments),this._virtualWorldsWithPlayers=new Map}get virtualWorldsWithPlayers(){return this._virtualWorldsWithPlayers}onPlayerEnteredScope(e){TriggerClientEvent(`${GetCurrentResourceName()}:refresh-virtual-world`,e.for)}setPlayerVirtualWorld(e,t){const r=this.getPlayerVirtualWorld(e);isNaN(r)||this._virtualWorldsWithPlayers.set(r,(this._virtualWorldsWithPlayers.has(r)?this._virtualWorldsWithPlayers.get(r):[]).filter((t=>t!==e)));const o=[...this._virtualWorldsWithPlayers.has(t)?this._virtualWorldsWithPlayers.get(t):[],e];this._virtualWorldsWithPlayers.set(t,o),global.exports.authentication.setPlayerInfo(e,"virtualWorld",t)}getPlayerVirtualWorld(e){return Math.max(0,Number(global.exports.authentication.getPlayerInfo(e,"virtualWorld")))}removeClientsideVehicles(){TriggerClientEvent(`${GetCurrentResourceName()}:ARM_remove-vehicles`,-1)}};i([l({eventName:"playerEnteredScope"})],c.prototype,"onPlayerEnteredScope",null),c=i([s()],c);var u=function(e,t,r,o){var n,s=arguments.length,l=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(l=(s<3?n(l):s>3?n(t,r,l):n(t,r))||l);return s>3&&l&&Object.defineProperty(t,r,l),l};let d=class extends c{constructor(){super(...arguments),this._clientsidedResourceMap=new Map}get clientsidedResourceMap(){return this._clientsidedResourceMap}getPlayerClientsidedCacheKey(e,t){if(this._clientsidedResourceMap.has(e)){const r=this._clientsidedResourceMap.get(e);if(r[t])return r[t]}return null}updatePlayerClientsidedCacheKey(e,t,r){const o=this._clientsidedResourceMap.has(e)&&this._clientsidedResourceMap.get(e)||{};o[t]=r,this._clientsidedResourceMap.set(e,o),TriggerClientEvent("armoury-overlay:update-resource-metadata",e,GetCurrentResourceName(),t,r)}onPlayerClientsidedCacheLoaded(e){e[GetCurrentResourceName()]&&this._clientsidedResourceMap.set(source,e[GetCurrentResourceName()])}onPlayerDisconnect(){this._clientsidedResourceMap.has(source)&&this._clientsidedResourceMap.delete(source)}};u([l()],d.prototype,"onPlayerClientsidedCacheLoaded",null),u([l()],d.prototype,"onPlayerDisconnect",null),d=u([s()],d);var h=function(e,t,r,o){var n,s=arguments.length,l=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(l=(s<3?n(l):s>3?n(t,r,l):n(t,r))||l);return s>3&&l&&Object.defineProperty(t,r,l),l};let p=class extends d{constructor(){super(...arguments),this._pets=new Map}get pets(){return this._pets}createPet(e,t){this._pets.set(t,e)}spawnPetForPlayerInVirtualWorld(e,t,r,o,n){if(this._pets.has(t)){const s=this._pets.get(t);console.log("pets sent owner ped network id:",n),TriggerClientEvent(`${GetCurrentResourceName()}:create-pet-for-player`,e,s,r,o||!1,n)}}despawnPetsForPlayer(e){TriggerClientEvent(`${GetCurrentResourceName()}:destroy-pets-for-player`,e)}getPetForVirtualWorld(e){return this._pets.has(e)?this._pets.get(e):null}onShouldSyncPetGreetWithOthers(e){e.forEach((e=>{TriggerClientEvent(`${GetCurrentResourceName()}:make-pet-greet-player`,e,!1,NetworkGetNetworkIdFromEntity(GetPlayerPed(source)))}))}onShouldSyncPetFollowWithOthers(e){e.forEach((e=>{TriggerClientEvent(`${GetCurrentResourceName()}:make-pet-follow-player`,e,!1,NetworkGetNetworkIdFromEntity(GetPlayerPed(source)))}))}};h([a()],p.prototype,"createPet",null),h([a()],p.prototype,"spawnPetForPlayerInVirtualWorld",null),h([a()],p.prototype,"despawnPetsForPlayer",null),h([a()],p.prototype,"getPetForVirtualWorld",null),h([l({eventName:`${GetCurrentResourceName()}:sync-greet-with-others`})],p.prototype,"onShouldSyncPetGreetWithOthers",null),h([l({eventName:`${GetCurrentResourceName()}:sync-pet-follow-with-others`})],p.prototype,"onShouldSyncPetFollowWithOthers",null),p=h([s()],p),new p})();